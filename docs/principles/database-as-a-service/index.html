<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://degreed.github.io/architecture/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://degreed.github.io/architecture/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://degreed.github.io/architecture/main.0e23ef2a6499cb086c856046ea468ad7ee3e1e2cffbef11da388a4f00d97cc3138ade0291ce5134fc4a131eb3b18fa431c1e875f3cb35955083e3f327a3141a5.css integrity="sha512-DiPvKmSZywhshWBG6kaK1+4+Hiz/vvEdo4ik8A2XzDE4reApHOUTT8ShMes7GPpDHB6HXzyzWVUIPj8yejFBpQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Database as a Service - Degreed Architecture</title><meta name=description content="This is the documentation on the Degreed Architecture. Here you can learn all about our architecture as a whole and how we develop."><link rel=canonical href=https://degreed.github.io/architecture/docs/principles/database-as-a-service/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://degreed.github.io/architecture/doks.png"><meta name=twitter:title content="Database as a Service"><meta name=twitter:description content="This principle only applies to the new development of our Domain APIs, which will use the JSON:API framework. Below you can find our reasoning behind the decision and what the implications are.
Change Management Stored Procedures should be treated to the same standards as the rest of our application. It needs to be part of our Continuous Integration pipeline, where automated tests run against it. It has proven difficult to apply versioning and automated tests for them."><meta name=twitter:site content="@degreed"><meta name=twitter:creator content="@degreed"><meta property="og:title" content="Database as a Service"><meta property="og:description" content="This principle only applies to the new development of our Domain APIs, which will use the JSON:API framework. Below you can find our reasoning behind the decision and what the implications are.
Change Management Stored Procedures should be treated to the same standards as the rest of our application. It needs to be part of our Continuous Integration pipeline, where automated tests run against it. It has proven difficult to apply versioning and automated tests for them."><meta property="og:type" content="article"><meta property="og:url" content="https://degreed.github.io/architecture/docs/principles/database-as-a-service/"><meta property="og:image" content="https://degreed.github.io/architecture/doks.png"><meta property="article:published_time" content="2021-02-04T12:15:09+01:00"><meta property="article:modified_time" content="2021-02-04T12:15:09+01:00"><meta property="og:site_name" content="Degreed Architecture"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/degreed.github.io\/architecture\/"},{"@type":"ListItem","position":2,"name":"Docs","item":"https:\/\/degreed.github.io\/architecture\/docs\/"},{"@type":"ListItem","position":3,"name":"Principles","item":"https:\/\/degreed.github.io\/architecture\/docs\/principles\/"},{"@type":"ListItem","position":4,"name":"Database as a Service","item":"https:\/\/degreed.github.io\/architecture\/docs\/principles\/database-as-a-service\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://degreed.github.io/architecture/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://degreed.github.io/architecture/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://degreed.github.io/architecture/favicon-16x16.png><link rel=manifest href=https://degreed.github.io/architecture/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=https://degreed.github.io/architecture/>Degreed Architecture</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/degreed/architecture><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://degreed.github.io/architecture/docs/prologue/introduction/>Docs</a></li><li class=nav-item><a class=nav-link href=https://degreed.github.io/architecture/changelog/>Changelog</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Prologue</h3><ul class=list-unstyled><li><a class=docs-link href=https://degreed.github.io/architecture/docs/prologue/introduction/>Introduction</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/prologue/unbundling-the-database/>Unbundling the Database</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/prologue/detangling-the-monolith/>Detangling the Monolith</a></li></ul><h3>Architecture Principles</h3><ul class=list-unstyled><li><a class=docs-link href=https://degreed.github.io/architecture/docs/principles/introduction/>Architecture Principles Introduction</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/principles/system-of-systems/>System of Systems</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/principles/evolution/>Evolutionary Architecture</a></li><li><a class="docs-link active" href=https://degreed.github.io/architecture/docs/principles/database-as-a-service/>Database as a Service</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/principles/smart-nodes-dumb-pipes/>Smart Nodes Dumb Pipes</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/principles/tools-of-the-trade/>Tools of the Trade</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/principles/the-degreed-platform/>The Degreed Platform</a></li></ul><h3>Domain APIs</h3><ul class=list-unstyled><li><a class=docs-link href=https://degreed.github.io/architecture/docs/domain/introduction/>Domain APIs Introduction</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/domain/domains/>The Domain in Domain APIs</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/domain/migrations/>Migrations</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/domain/locality/>Locality</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/domain/infrastructure/>Infrastructure</a></li></ul><h3>Application Services</h3><ul class=list-unstyled><li><a class=docs-link href=https://degreed.github.io/architecture/docs/applications/introduction/>Application Services Introduction</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/applications/communication/>Communication</a></li></ul><h3>Event-Driven Architecture</h3><ul class=list-unstyled><li><a class=docs-link href=https://degreed.github.io/architecture/docs/events/introduction/>Event-Driven Architecture Introduction</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/events/state-events/>State Events</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/events/application-events/>Application Events</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/events/event-store/>Event Store</a></li></ul><h3>Legacy System</h3><ul class=list-unstyled><li><a class=docs-link href=https://degreed.github.io/architecture/docs/legacy/introduction/>Legacy Introduction</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/legacy/applications/>Applications</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/legacy/data/>Data</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/legacy/messaging/>Messaging</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/legacy/services/>Services</a></li></ul><h3>Help</h3><ul class=list-unstyled><li><a class=docs-link href=https://degreed.github.io/architecture/docs/help/how-to-contribute/>How to Contribute</a></li><li><a class=docs-link href=https://degreed.github.io/architecture/docs/help/faq/>FAQ</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#change-management>Change Management</a></li><li><a href=#database-as-a-service>Database as a service</a></li><li><a href=#monolithic-database>Monolithic Database</a></li><li><a href=#tooling>Tooling</a></li><li><a href=#implications>Implications</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Database as a Service</h1><p class=lead>In the past we have relied heavily on Stored Procedures. With the shift to a "System of Systems" design, where our goal is to increase autonomy for our teams, we have decided to build domain APIs which don’t use Stored Procedures.</p><p>This principle only applies to the new development of our Domain APIs, which will use the <a href=https://www.jsonapi.net>JSON:API framework</a>. Below you can find our reasoning behind the decision and what the implications are.</p><h2 id=change-management>Change Management<a href=#change-management class=anchor aria-hidden=true>#</a></h2><p>Stored Procedures should be treated to the same standards as the rest of our application. It needs to be part of our Continuous Integration pipeline, where automated tests run against it. It has proven difficult to apply versioning and automated tests for them. This makes it hard for us to reach the quality of Continuous deployment and zero downtime that we desire.</p><h2 id=database-as-a-service>Database as a service<a href=#database-as-a-service class=anchor aria-hidden=true>#</a></h2><p>We are moving towards a Database as a Service model where each Domain API will access its own persistent storage, completely independent of other Domain APIs.</p><p>This means that we can use persistence which is optimal to the domain. Using Stored Procedures binds us to a specific technology. Using Entity Framework means you could with relative low effort switch between SQL Server, PostgreSQL and Cosmos DB.</p><h2 id=monolithic-database>Monolithic Database<a href=#monolithic-database class=anchor aria-hidden=true>#</a></h2><p>Stored Procedures are often applied when different domains and teams re-use the same data layer. They allowed us to create an abstraction at the lowest level and making sure that it’s reflected across the business.</p><p>The <a href=https://degreed.github.io/architecture/docs/domain/introduction/>Domain APIs</a> will be the lowest level access you can get to data, meaning that we can now move that logic into the application layer.</p><h2 id=tooling>Tooling<a href=#tooling class=anchor aria-hidden=true>#</a></h2><p>Developer tooling has made leaps and bounds in the past years. From programming language advancements, to tools which help you during development (editors, source control, linters).</p><p>One of these tools in our toolbox as Degreed developers is the <a href=https://www.jsonapi.net>JSON:API framework</a>, which enables us to easily release a best-in-class REST API for access to our data.</p><p>The JSON:API framework depends heavily on <a href=https://docs.microsoft.com/en-us/ef/core/>Entity Framework Core</a> (EF Core) to generate dynamic SQL statements. Continuing to make use of Stored Procedures would negate a lot of its capabilities.</p><h2 id=implications>Implications<a href=#implications class=anchor aria-hidden=true>#</a></h2><ul><li><p>Consider the use of Stored Procedures as premature optimization. Only use Stored Procedures for the most critical performance situations and when the application layer has failed to satisfy a particular requirement.</p></li><li><p>Don&rsquo;t use Stored Procedures for business logic, all business logic should be in the <a href=https://degreed.github.io/architecture/docs/applications/introduction/ title="Application Services">Application Services</a>.</p></li><li><p>No more use of Stored Procedures for access management or validation of inputs. This should all reside in the application, before being sent to the persistence layer.</p></li><li><p>If you require to use Stored Procedures for reads, always start with views as they are much easier to use and they integrate better with EF Core, a core component of our JSON:API framework.</p></li></ul><p class=edit-page><a href=https://github.com/degreed/architecture/blob/master/content/docs/principles/database-as-a-service.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a href=https://degreed.github.io/architecture/docs/principles/evolution/><div class="card my-1"><div class="card-body py-2">&larr; Evolutionary Architecture</div></div></a><a class=ml-auto href=https://degreed.github.io/architecture/docs/principles/smart-nodes-dumb-pipes/><div class="card my-1"><div class="card-body py-2">Smart Nodes Dumb Pipes &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline></ul></div></div></div></footer><script src=https://degreed.github.io/architecture/main.f6b484f556ad1f3bcf6061082139a2f21fa759f13930c39a25fe4a9f78f35e64122c2d86dffd56e67b292dabbda4095d8077194f196e0e348441c106a9f3d40e.js integrity="sha512-9rSE9VatHzvPYGEIITmi8h+nWfE5MMOaJf5Kn3jzXmQSLC2G3/1W5nspLau9pAldgHcZTxluDjSEQcEGqfPUDg==" crossorigin=anonymous defer></script><script src=https://degreed.github.io/architecture/index.min.99dfaae884ce1b1197c1b05e8e835f2de808d4443253e70c4f2de7e9b70b51b5c58526640f4f4e10a68654ab724c8499389a2da4e0019d2809d0e795dcd98fba.js integrity="sha512-md+q6ITOGxGXwbBejoNfLegI1EQyU+cMTy3n6bcLUbXFhSZkD09OEKaGVKtyTISZOJotpOABnSgJ0OeV3NmPug==" crossorigin=anonymous defer></script></body></html>